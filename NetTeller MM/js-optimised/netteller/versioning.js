define(["lib/jquery","netteller/rest","config/environment"],function(e,t,n){var r=null,i=null,s=null,o=function(){i=e.Deferred(),s=new Date,e.ajax({url:t.ntsRoot+n.strings["app.version.check.uri"],dataType:"json",success:function(e){r=e,i.resolve()},error:function(){r=null,i.resolve()},type:"GET"})},u=function(e){var i={match:!1,message:""};if(r&&r.versions&&r.versions.length>0){var s=n.strings["app.version"];s=s.slice(0,s.lastIndexOf("."));for(var o=0;o<r.versions.length;o++)if(s===r.versions[o]){i.match=!0;break}if(i.match)return e(i);t.globalEnable=!1;if(window.noPhoneGap===!0)return i.message=n.strings["msg.version.needsupdate.default"],e(i);require(["ui/platform!"],function(t){t.android?i.message=n.strings["msg.version.needsupdate.android"]:t.ios&&(i.message=n.strings["msg.version.needsupdate.ios"]),e(i)})}return i.match=!0,e(i)};o();var a={checkCompatible:function(e){var t=Number(n.strings["app.version.check.period"]),r=s===null?0:(new Date).getTime()-s.getTime();if(i===null||i.state()!=="pending"&&r>=t)return o(),a.checkCompatible(e);i.done(function(){u(e)})}};return a})