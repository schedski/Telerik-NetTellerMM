define(["lib/jquery","netteller/session","lib/knockout","ui/loader","netteller/localstorage","netteller/pin","config/environment"],function(e,t,n,r,i,s,o){var u={customerNumber:n.observable(""),password:n.observable(""),pinCode:n.observable(""),loginModeEnum:{Password:0,Pin:1},loginMode:n.observable(),termsAndConditions:{Message:n.observable(""),MessageXML:n.observable(""),MessageUrl:n.observable("")},loginLoader:new r.TimedLoader(o.strings["loader.login"]),setTermsAndConditions:function(e){u.termsAndConditions.Message(e.NotificationMessage),u.termsAndConditions.MessageXML(e.NotificationXMLMessage),u.termsAndConditions.MessageUrl(e.NotificationUrl)},requestCommand:{StartLoginProcess:0,TermsAndConditionsAccepted:2},responseCommand:{MustAcceptTermsAndConditions:1,AcceptLogin:5,LoginProcessAccepted:8,LoginProcessDeclined:9,ForcePasswordChange:10},reset:function(){u.customerNumber(""),u.password(""),u.termsAndConditions.Message(""),u.termsAndConditions.MessageXML(""),u.termsAndConditions.MessageUrl("")},doLoginWorkFlowStep:function(e,n,r,i){u.customerNumber(e),u.password(n),t.login(e,n,r,i)},doAcceptLoginWorkFlowStep:function(e){t.acceptLogin(e)},doChangePasswordWorkFlowStep:function(e,n,r){t.changePassword(e,n,u.password(),r)},doLoginProcessAcceptedStep:function(t){t===!0&&!i.hasBeenAskedAboutPin()?(s.pinMode(s.pinModeEnum.Register),e.mobile.changePage("#registerExistingPin")):i.hasBeenAskedAboutPin()?e.mobile.changePage("#accounts"):(s.pinMode(s.pinModeEnum.Register),e.mobile.changePage("#register"))}};return u})