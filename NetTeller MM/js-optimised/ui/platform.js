define(["lib/jquery","lib/toolkit"],function(e,t){var n={},r=function(){var n=!1;if(window.device&&window.device.cordova){var r=t.cleanField(window.device.platform),i=t.cleanField(String(window.device.version)),s=t.hasValue(i)&&i.indexOf(".")>=1?Number(i.slice(0,i.indexOf("."))):0,o=0;if(t.hasValue(i)){var u=i.split(".");u.length>=2&&(o=Number(u[1]))}n={android:r==="android",ios:r==="iphone"},e.extend(n,{android2x:n.android&&s===2,android3plus:n.android&&s>=3,android41plus:n.android&&s===4&&o>=1}),e.extend(n,{features:{hasBackKey:n.android}})}return n},i=function(e,t){var n=150;if(e.state!=="pending")return;if(window.device&&window.device.cordova){e.resolve();return}t>=n?window.setTimeout(function(){i(e,t-n)},n):e.resolve()};return n.load=function(t,n,s,o){var u=e.Deferred();u.done(function(){s(r())}),window.noPhoneGap?u.resolve():(document.addEventListener("deviceready",u.resolve,!1),i(u,2e3))},n})